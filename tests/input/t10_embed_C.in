C__decl [[
typedef struct MyStruct {
    int a;
} MyStruct;
]]

function demo(u: Userdata)

    C__unsafe(u) [[
        MyStruct *s = (MyStruct *) u.ptr;
    ]]

end
#
local i: integer = 1
local j: integer = 2
local k: integer

C__unsafe(i,j,k) [[
     k = i+j; // Okay as primitive types
]]
#
C__decl [[
   typedef struct {
      int i;
  } MyStruct;
]]

local u = C__new('MyStruct', 1)

local i: integer = 42
local j: integer

C__unsafe(i,j,u) [[
    MyStruct *s = (MyStruct *) u.ptr;
    s->i = i;
    j = s->i;
]]

return j